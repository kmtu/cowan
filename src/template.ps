%!PS-Adobe-3.0
<< /PageSize [ 595 842 ] /ImagingBBox null >> setpagedevice
72 25.4 div dup scale %use mm-units

/pageHeight 297 def
/pageWidth 210 def

/marginLeft pageWidth 15 div def
/marginRight marginLeft def
/marginTop pageHeight 30 div def
/marginBot marginTop def

/boundTop pageHeight marginTop sub def
/boundLeft marginLeft def

/numRecords 45 def
/numFrames 100 def
/recordHeight pageHeight 2 div numRecords div def

/vertAxis boundLeft marginLeft add def
/vertAxis2 pageWidth marginRight 2 mul sub def

/waterLabelAlign {vertAxis (00000) stringwidth pop sub} bind def
recordHeight 1.2 div 4 lt {/waterLabelFontSize recordHeight 1.2 div def} 
{/waterLabelFontSize 4 def} ifelse 
/generalFontSize pageWidth 50 div def

/Helvetica findfont
generalFontSize scalefont
setfont

/minVertTick vertAxis pageWidth 40 div add def
/maxVertTick vertAxis2 pageWidth 40 div sub def
/numVertTicks 10 def
/vertTickSpace maxVertTick minVertTick sub numVertTicks 1 sub div def

/horiAxis1 boundTop numRecords 1 add recordHeight mul sub def
/horiAxis3 marginBot marginBot add def
/horiAxis2 horiAxis1 horiAxis3 add 2 div def

/minHoriTick horiAxis2 pageHeight 40 div add def
/maxHoriTick horiAxis1 pageHeight 40 div pageHeight 60 div add sub def
/minHoriTickNum 3 def
/maxHoriTickNum 7 def
/numHoriTicks maxHoriTickNum minHoriTickNum sub 1 add def
/horiTickSpace maxHoriTick minHoriTick sub numHoriTicks 1 sub div def


/dataPointSpace maxVertTick minVertTick sub numFrames 1 sub div def

/HSBoxHeight recordHeight 2 div def
/HSBoxWidth dataPointSpace def
/HSBox {
	newpath
	moveto
	HSBoxWidth 2 div 0 rlineto
	0 HSBoxHeight rlineto
	HSBoxWidth neg 0 rlineto
	0 HSBoxHeight neg rlineto
	closepath
	fill
} bind def

/vertTickLength pageHeight 200 div def
/vertTick {
  newpath
  moveto
  0 vertTickLength rlineto
  stroke
} bind def

/horiTickLength pageHeight 200 div def
/horiTick {
  newpath
  moveto
  horiTickLength 0 rlineto
  stroke
} bind def

/arrowhead {% stack: s x1 y1, current point: x0 y0 
  gsave 
    currentpoint % s x1 y1 x0 y0 
    4 2 roll exch % s x0 y0 y1 x1 
    4 -1 roll exch % s y0 y1 x0 x1 
    sub 3 1 roll % s x1-x2 y0 y1 
    sub exch % s y0-y1 x1-x2 
    atan rotate % rotate over arctan((y0-y1)/(x1-x2)) 
    dup scale % scale by factor s
    currentpoint exch 2 add exch moveto
    -5 2 rlineto 1 -2 rlineto -1 -2 rlineto 
    closepath fill % fill arrowhead 
  grestore 
} def
%%%%%% def end %%%%%%

%set suitable linewidth
pageHeight 600 div pageWidth 400 div lt
{pageHeight 600 div} {pageWidth 400 div} ifelse setlinewidth

%set line cap to round cap
1 setlinecap

%draw vertAxis
newpath
vertAxis boundTop moveto
vertAxis horiAxis1 lineto 
stroke

newpath
vertAxis horiAxis2 moveto
vertAxis horiAxis1 pageHeight 60 div sub lineto
0.6 vertAxis horiAxis2 arrowhead
stroke
%draw horiTick with labels
0 1 numHoriTicks 1 sub {
  dup horiTickSpace mul minHoriTick add vertAxis exch horiTick
  newpath
  dup horiTickSpace mul minHoriTick add pageHeight 200 div sub vertAxis (00) stringwidth pop sub exch moveto
  minHoriTickNum add 1 string cvs show
} for
gsave
  /Helvetica findfont
  generalFontSize 1.3 mul scalefont
  setfont
  newpath
  boundLeft (0) stringwidth pop add horiAxis1 horiAxis2 add 2 div moveto
  (n) show
grestore

newpath
vertAxis horiAxis3 moveto
vertAxis horiAxis2 pageHeight 60 div sub lineto
0.6 vertAxis horiAxis3 arrowhead
stroke
%draw vertical axis label
gsave
  /Helvetica findfont
  generalFontSize 1.3 mul scalefont
  setfont
  newpath
  boundLeft (0) stringwidth pop add horiAxis2 horiAxis3 add 2 div moveto
  (z) show
grestore

%draw horiAxis1 and arrowhead
newpath
boundLeft horiAxis1 moveto
vertAxis2 horiAxis1 lineto
0.6 vertAxis2 1 sub horiAxis1 arrowhead
stroke
%draw vertTick
0 1 numVertTicks 1 sub {
  vertTickSpace mul minVertTick add horiAxis1 vertTick
} for

%draw horiAxis2 and arrowhead
newpath
boundLeft horiAxis2 moveto
vertAxis2 horiAxis2 lineto
0.6 vertAxis2 1 sub horiAxis2 arrowhead
stroke
%draw vertTick
0 1 numVertTicks 1 sub {
  vertTickSpace mul minVertTick add horiAxis2 vertTick
} for

%draw horiAxis3 and arrowhead
newpath
boundLeft horiAxis3 moveto
vertAxis2 horiAxis3 lineto
0.6 vertAxis2 1 sub horiAxis3 arrowhead
stroke
%draw vertTick with labels
0 1 numVertTicks 1 sub {
  dup vertTickSpace mul minVertTick add horiAxis3 vertTick
  newpath
  dup 1 add 20 mul
  dup exch 10 lt {pop /temp (0) def} {100 lt {/temp (00) def} {/temp (000) def} ifelse} ifelse
  dup vertTickSpace mul minVertTick add temp stringwidth pop 2 div sub
  horiAxis3 pageHeight 60 div sub moveto
  1 add 20 mul 3 string cvs show
} for


newpath
vertAxis2 (0) stringwidth pop add horiAxis1 pageHeight 290 div sub moveto
(t/ps) show

newpath
vertAxis2 (0) stringwidth pop add horiAxis2 pageHeight 290 div sub moveto
(t/ps) show

newpath
vertAxis2 (0) stringwidth pop add horiAxis3 pageHeight 290 div sub moveto
(t/ps) show


/Helvetica findfont
waterLabelFontSize scalefont
setfont

%draw water records
%%%% Fortran loop starts
newpath
/order 1 def
waterLabelAlign boundTop recordHeight order mul sub moveto
(839) show
minVertTick HSBoxWidth 0 mul add boundTop recordHeight order mul sub HSBox
minVertTick HSBoxWidth 3 mul add boundTop recordHeight order mul sub HSBox

newpath
/order 2 def
waterLabelAlign boundTop recordHeight order mul sub moveto
(1025) show
minVertTick HSBoxWidth 4 mul add boundTop recordHeight order mul sub HSBox
minVertTick HSBoxWidth 5 mul add boundTop recordHeight order mul sub HSBox

newpath
/order 3 def
waterLabelAlign boundTop recordHeight 3 mul sub moveto
(1028) show
minVertTick HSBoxWidth 4 mul add boundTop recordHeight order mul sub HSBox
minVertTick HSBoxWidth 7 mul add boundTop recordHeight order mul sub HSBox
%%%% Fortran loop ends


%draw n
gsave
1 setlinejoin
newpath
%%%% Fortran loop starts
/data 3 def
/point data minHoriTickNum sub def
minVertTick dataPointSpace 0 mul add minHoriTick horiTickSpace point mul add moveto

/data 5 def
/point data minHoriTickNum sub def
minVertTick dataPointSpace 1 mul add minHoriTick horiTickSpace point mul add lineto

/data 4 def
/point data minHoriTickNum sub def
minVertTick dataPointSpace 2 mul add minHoriTick horiTickSpace point mul add lineto
%%%% Fortran loop ends
stroke
grestore


%draw tube top and bottom line
/topLimit horiAxis2 pageHeight 60 div sub def
/botLimit horiAxis3 def
/graphRange topLimit botLimit sub def

/dataTopLimit 27 def
/dataBotLimit -27 def
/dataRange dataTopLimit dataBotLimit sub def

/changeToGraph {
  dataBotLimit sub dataRange div graphRange mul botLimit add
} def

/dataTubeTop 13 def
/dataTubeBot -13 def
/tubeTopAxis dataTubeTop changeToGraph def
/tubeBotAxis dataTubeBot changeToGraph def
gsave
  0 setlinecap
  [dataPointSpace 2 div dup 1.5 mul ] 0 setdash
  newpath
  vertAxis tubeTopAxis moveto
  vertAxis2 tubeTopAxis lineto
  stroke
  newpath
  vertAxis tubeBotAxis moveto
  vertAxis2 tubeBotAxis lineto
  stroke
grestore
%draw labels
/MyHelvetica findfont
generalFontSize scalefont
setfont
newpath
/label dataTubeTop 3 string cvs def
vertAxis label stringwidth pop (0) stringwidth pop 2 div add sub tubeTopAxis pageHeight 200 div sub moveto
label show
/label dataTubeBot 3 string cvs def
vertAxis label stringwidth pop (0) stringwidth pop 2 div add sub tubeBotAxis pageHeight 200 div sub moveto
label show
/label (AA) def
vertAxis label stringwidth pop (0) stringwidth pop 2 div add sub horiAxis2 pageHeight 60 div sub moveto
label show


gsave
1 setlinejoin
newpath
%%%% Fortran loop starts
/data 19 def
minVertTick dataPointSpace 0 mul add data changeToGraph moveto
/data 17 def
minVertTick dataPointSpace 1 mul add data changeToGraph lineto
/data 16 def
minVertTick dataPointSpace 2 mul add data changeToGraph lineto
%%%% Fortran loop ends
stroke
grestore


showpage